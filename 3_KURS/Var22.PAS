Uses crt;
Const
    {Задаются степень полинома (2) и количество пар данных}
     n = 3;
     h = 12;
     {Задаются исходные данные}
     X_:array[1..h] of real =
        (1,  2.5,  3,  4,  4.5,  6,  7,  10,  12, 14,  16, 20 );
     Y_:array [1..h] of real =
        (0.5, 5.8, 8.6,15.5, 19.7, 35.4, 48.5, 99.7, 145, 195.5, 258, 400.3);
Var
     {Описываются массивы:
     A(n, n) - коэффициенты системы уравнений
     b(n) - свободные члены системы уравнений
     C(2 * n) - промежуточная переменная, при расчете коэффициентов системы
                уравнений
     X (n) - коэффициенты полинома (рассчитываются)}
    a: array [1..n, 1..n] of real;
    b, X : array [1..n] of real;
    C: array [1..2*n] of real;
    a_, a1_, a2_, a3_ : real;
    i,j, k: integer;
    key:boolean;
    Y1  :real;

    { Функция возвевения в степень }
    function pow(x, p:real):real;
    begin
         pow:= abs(x)/x*exp(p*ln(abs(x)))
    end;

Begin
     Clrscr;
     Writeln('Данная программа осуществляет нелинейный парный регрессивный анализ');
     writeln('на примере аппроксимации полиномом 2-ой степени, для следующих данных:');
     for i:=1 to n do
          for j:= 1 to 2 * n - 1 do
          begin
               if j <= n then     {Расчет кэффициентов: b(j) и c(j)}
                  b[j]:= b[j] + Y_[i] * pow(X_[i],j - 1);
               C[j]:= C[j] + pow(X_[i],j - 1)
          end;
     {Составление коэффициентов для системы уравнений}
     for i:= 1 to n do
     begin
          k:= i;
          for j:= 1 to n do
          begin
               a[i, j]:= C[k];
               k:= k + 1
          end
     end;
     {Решение системы уравнений методом Крамера}
     a_:=a[1, 1]*a[2,2]*a[3,3]+a[1,2]*a[2,3]*a[3,1]+a[1,3]*a[2,1]*a[3,2];
     a_:=a_-a[3,1]*a[2,2]*a[1,3]-a[3,2]*a[2,3]*a[1,1]-a[3,3]*a[2,1]*a[1,2];
     a1_:=b[1]*a[2,2]*a[3,3]+a[1,2]*a[2,3]*b[3]+a[1,3]*b[2]*a[3,2];
     a1_:=a1_-b[3]*a[2,2]*a[1,3]-a[3,2]*a[2,3]*b[1]-a[3,3]*b[2]*a[1,2];
     a2_:=a[1,1]*b[2]*a[3,3]+b[1]*a[2,3]*a[3,1]+a[1,3]*a[2,1]*b[3];
     a2_:=a2_-a[3,1]*b[2]*a[1,3]-b[3]*a[2, 3]*a[1,1]-a[3,3]*a[2,1]*b[1];
     a3_:=a[1,1]*a[2,2]*b[3]+a[1,2]*b[2]*a[3,1]+b[1]*a[2,1]*a[3,2];
     a3_:=a3_-a[3,1]*a[2,2]*b[1]-a[3,2]*b[2]*a[1,1]-b[3]*a[2,1]*a[1,2];
     X[1]:=a1_/a_; X[2]:=a2_/a_; X[3]:=a3_/a_;
     {Вывод коэффициентов полинома на экран}

     Writeln('Коэффициенты полинома:');
     for i:= 1 to n do
         Writeln('A(', i, ')=', X[i]:6:2);
     Writeln(' i  |  X(i) |  Y(i)    |  Y1(i)');
     Writeln('-------------------------------');
     for i:= 1 to h do
         begin
          {Расчет ф-ции Y1(x) по табличным данным}
          Y1:= X[1] + X[2] * X_[i] + X[3] * X_[i]*X_[i];
          Writeln(i:5, X_[i]:8:2, Y_[i]:8:2, Y1:8:2)
         end;
     {Расчет ф-ции Y1(x) по введенным значениям}
     key:=true;
     Writeln('Выход из цикла -999');
     while (key) do
     begin
          Write(' Введите X= ');
          Read(a_);
          if (a_ = -999 ) then  key := False
          else
          begin
             Y1:= X[1] + X[2] * a_ + X[3] * a_*a_;
             Writeln('Значение Y(X) = ', Y1:8:2)
          end
     end
End.
