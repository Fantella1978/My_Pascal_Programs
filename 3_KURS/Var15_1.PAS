{Сглаживание результатов эксперимента
нелинейное сглаживание по 7-и ординатам

Первым делом заполняем массив "результатов
эксперимента" 20-ю значениями, рассчитанны-
ми по формуле (см.условие) Yi=(e^x+e^(-x))/2
где Хн=0.1, шаг h=0.05 (Xi=0.1+h*i, i=(0...19))}

Uses Crt;
Var
	X, Y, Ys : array [0..19] of real;
        a,b,c,d,e,f,g,
        i, k, l : integer;
Const

   {дальше - задаем матрицу коэффициентов
	 имя переменной для соответств. коэффициента:
	 (a) (b) (c) (d) (e) (f) (g)}
   aa: array[0..6] of integer = (39, 8, -4, -4,  1,  4, -2);
   ba: array[0..6] of integer = (8, 19, 16,  6, -4, -7,  4);
   ca: array[0..6] of integer = (-4, 16, 19, 12,  2, -4,  1);
   da: array[0..6] of integer = (-4,  6, 12, 14, 12,  6, -4);
   ea: array[0..6] of integer = (1, -4,  2, 12, 19, 16, -4);
   fa: array[0..6] of integer = (4, -7, -4,  6, 16, 19,  8);
   ga: array[0..6] of integer = (-2,  4,  1, -4, -4,  8, 39);

Begin
	clrscr; {очистка экрана}
	writeln('Нелинейное сглаживание результатов эксперимента');
	writeln( '            по 7 ординатам');
	writeln( ' X(i)            Y(i)             Y~(i)');

	{объявляем мссивы для Х, Y и сглаженных значений
	x, y и ys соответственно ...
	... заполняем массивы Х и Y }
	for i:=0 to 19 do
	begin
		X[i]:= 0.1+0.05*i;
		Y[i]:=(EXP(X[i]) + EXP(-X[i])) / 2
	end;

	{ Теперь, собственно, само сглаживание:
	Ys(i)=a*Y(i-3)+b*Y(i-2)+c*Y(i-1)+d*Y(i)+e*Y(i+1)+f*Y(i+2)+g*Y(i+3)}
        l:=0;
	for i:=0 to 19 do
            begin
		if ((i < 4) OR (i > 16)) then
                begin
		     a:=aa[l]; b:=ba[l]; c:=ca[l]; d:=da[l]; e:=ea[l];
                     f:=fa[l]; g:=ga[l];
                     Inc(l);
                     if i < 4 then k:= 3 else k:= 16
                end
                else k:=i;

                {т.е. менять коэффииенты нужно для первых четырех
                и для последних трех итераций (всего 20 итераций),
                а новые Y(i)-тые подставлять при 3<i<16 (16=N-3)}
                Ys[i]:=(a*Y[k - 3]+b*Y[k-2]+c*Y[k-1]+d*Y[k]+e*Y[k+1]+f*Y[k+2]+g*Y[k+3])/42;
                {Выводим иходный массив и результаты сглаживания}
                 writeln( 'X(',i,')=', X[i]:6:2, ';   Y(',i,')=', Y[i]:6:2, ';     Ys(',i,')', Ys[i]:6:2 )
        end;
End.

